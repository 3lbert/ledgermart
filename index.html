<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Supermarket Loading</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&display=swap" rel="stylesheet">

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: "Baloo 2", sans-serif;
    background: #f6f7fb;
    overflow: hidden;
  }

  #splash {
    position: fixed;
    inset: 0;
    background: linear-gradient(#e3f4ff, #cfeaff);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    /* fadeOut dinonaktifkan agar tidak white screen */
    /* animation: fadeOut 0.8s ease-out 2.4s forwards; */
  }

  .bubble {
    position: absolute;
    background: #fff;
    border-radius: 22px;
    box-shadow: 0px 5px 0px #b6d5e8;
    animation: float 3s ease-in-out infinite alternate;
  }

  .b1 { width: 200px; height: 80px; top: 12%; left: 8%; animation-delay: 0s; }
  .b2 { width: 260px; height: 90px; bottom: 10%; right: 10%; animation-delay: 0.6s; }
  .b3 { width: 160px; height: 70px; top: 60%; left: 22%; animation-delay: 1.2s; }

  @keyframes float {
    from { transform: translateY(0); }
    to { transform: translateY(-18px); }
  }

  .splash-logo {
    width: 330px;
    animation: popCartoon 1.1s cubic-bezier(.25,1.6,.35,1);
    filter: drop-shadow(8px 8px 0px rgba(0,0,0,0.2));
  }

  @keyframes popCartoon {
    0% { transform: scale(0) rotate(-10deg); }
    40% { transform: scale(1.25, 0.75) rotate(3deg); }
    70% { transform: scale(0.9, 1.1) rotate(-2deg); }
    100% { transform: scale(1) rotate(0deg); }
  }

  .loading-wrap {
    width: 70%;
    max-width: 420px;
    height: 30px;
    background: #fff;
    border: 4px solid #2da4ff;
    border-radius: 30px;
    margin-top: 40px;
    padding: 5px;
    box-shadow: 0px 6px 0px #1877c1;
  }

  .loading-bar {
    width: 0%;
    height: 100%;
    border-radius: 25px;
    background: repeating-linear-gradient(
      -45deg,
      #ffcd3c,
      #ffcd3c 15px,
      #ffb300 15px,
      #ffb300 30px
    );
    transition: width .25s ease-out;
    box-shadow: inset 0px 0px 10px rgba(0,0,0,0.2);
  }

  #loading-text {
    margin-top: 12px;
    font-size: 22px;
    color: #0b4173;
    text-shadow: 2px 2px 0px white;
  }

  @keyframes fadeOut {
    to { opacity: 0; visibility: hidden; }
  }

</style>
</head>

<body>

<div id="splash">
  <div class="bubble b1"></div>
  <div class="bubble b2"></div>
  <div class="bubble b3"></div>

  <img src="BU-SOC Accounting Laboratory-01.png" class="splash-logo">

  <div class="loading-wrap">
    <div class="loading-bar" id="loading-bar"></div>
  </div>

  <div id="loading-text">Loading...</div>
</div>

<script>
/* ===============================
      SUPER ACCURATE PRELOAD
      TANPA FADEOUT
      TANPA WHITE SCREEN
      0–100% REALTIME
   =============================== */

document.addEventListener("DOMContentLoaded", () => {

  const assets = [
    "title-background.jpg"
    "Dalam Toko.png"
    "2.png",
    "alien.png",
    "customer_a.png",
    "customer_b.png",
    "customer_c.png",
    "thief_run.png"
  ];

  let loaded = 0;
  const loadingText = document.getElementById("loading-text");
  const loadingBar = document.getElementById("loading-bar");

  function addNoCache(src) {
    return src + "?v=" + crypto.randomUUID();
  }

  function preloadAsset(src) {
    return new Promise((resolve) => {
      const timeout = setTimeout(resolve, 2500);

      if (/\.(mp3|wav)$/i.test(src)) {
        const audio = new Audio();
        audio.src = src;

        const done = () => {
          clearTimeout(timeout);
          resolve();
        };

        audio.addEventListener("loadeddata", done, { once: true });
        audio.addEventListener("canplaythrough", done, { once: true });
        audio.addEventListener("error", done, { once: true });
        return;
      }

      const img = new Image();
      img.src = src;

      img.onload = () => { clearTimeout(timeout); resolve(); };
      img.onerror = () => { clearTimeout(timeout); resolve(); };
    });
  }

  function updateProgress() {
    let percent = Math.floor((loaded / assets.length) * 100);
    loadingText.textContent = "Loading... " + percent + "%";
    loadingBar.style.width = percent + "%";
  }

  async function preloadAll() {
    for (let src of assets) {
      let realSrc = addNoCache(src);

      await preloadAsset(realSrc);

      loaded++;
      updateProgress();
    }

    /* Langsung pindah halaman — no fade, no delay */
    window.location.href = "toserba game.html";
  }

  preloadAll();
});
</script>

</body>
</html>







